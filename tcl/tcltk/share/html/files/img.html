<!DOCTYPE html><html><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>img - Img</title>
<style type="text/css"><!--
    HTML {
	background: 	#FFFFFF;
	color: 		black;
    }
    BODY {
	background: 	#FFFFFF;
	color:	 	black;
    }
    DIV.doctools {
	margin-left:	10%;
	margin-right:	10%;
    }
    DIV.doctools H1,DIV.doctools H2 {
	margin-left:	-5%;
    }
    H1, H2, H3, H4 {
	margin-top: 	1em;
	font-family:	sans-serif;
	font-size:	large;
	color:		#005A9C;
	background: 	transparent;
	text-align:		left;
    }
    H1.doctools_title {
	text-align: center;
    }
    UL,OL {
	margin-right: 0em;
	margin-top: 3pt;
	margin-bottom: 3pt;
    }
    UL LI {
	list-style: disc;
    }
    OL LI {
	list-style: decimal;
    }
    DT {
	padding-top: 	1ex;
    }
    UL.doctools_toc,UL.doctools_toc UL, UL.doctools_toc UL UL {
	font:		normal 12pt/14pt sans-serif;
	list-style:	none;
    }
    LI.doctools_section, LI.doctools_subsection {
	list-style: 	none;
	margin-left: 	0em;
	text-indent:	0em;
	padding: 	0em;
    }
    PRE {
	display: 	block;
	font-family:	monospace;
	white-space:	pre;
	margin:		0%;
	padding-top:	0.5ex;
	padding-bottom:	0.5ex;
	padding-left:	1ex;
	padding-right:	1ex;
	width:		100%;
    }
    PRE.doctools_example {
	color: 		black;
	background: 	#f5dcb3;
	border:		1px solid black;
    }
    UL.doctools_requirements LI, UL.doctools_syntax LI {
	list-style: 	none;
	margin-left: 	0em;
	text-indent:	0em;
	padding:	0em;
    }
    DIV.doctools_synopsis {
	color: 		black;
	background: 	#80ffff;
	border:		1px solid black;
	font-family:	serif;
	margin-top: 	1em;
	margin-bottom: 	1em;
    }
    UL.doctools_syntax {
	margin-top: 	1em;
	border-top:	1px solid black;
    }
    UL.doctools_requirements {
	margin-bottom: 	1em;
	border-bottom:	1px solid black;
    }
--></style>
</head>
<!-- Generated from file 'img.man' by tcllib/doctools with format 'html'
   -->
<!-- Copyright &amp;copy; 1995-2024 Jan Nijtmans &amp;lt;nijtmans@users.sourceforge.net&amp;gt;   -- Copyright &amp;copy; 2002-2024 Andreas Kupries &amp;lt;andreas_kupries@users.sourceforge.net&amp;gt;   -- Copyright &amp;copy; 2003-2024 Paul Obermeier &amp;lt;obermeier@users.sourceforge.net&amp;gt;
   -->
<!-- img.n
   -->
<body><hr> [
   <a href="../toc.html">Table Of Contents</a>
 ] <hr>
<div class="doctools">
<h1 class="doctools_title">img(n) 2.0 doc &quot;Img&quot;</h1>
<div id="name" class="doctools_section"><h2><a name="name">Name</a></h2>
<p>img - Introduction to Img</p>
</div>
<div id="toc" class="doctools_section"><h2><a name="toc">Table Of Contents</a></h2>
<ul class="doctools_toc">
<li class="doctools_section"><a href="#toc">Table Of Contents</a></li>
<li class="doctools_section"><a href="#synopsis">Synopsis</a></li>
<li class="doctools_section"><a href="#section1">Description</a></li>
<li class="doctools_section"><a href="#section2">Notes</a></li>
<li class="doctools_section"><a href="#section3">Multi-page Images</a></li>
<li class="doctools_section"><a href="#section4">Image Metadata</a></li>
<li class="doctools_section"><a href="#section5">Value Mapping</a></li>
<li class="doctools_section"><a href="#section6">Matching Order</a></li>
<li class="doctools_section"><a href="#see-also">See Also</a></li>
<li class="doctools_section"><a href="#copyright">Copyright</a></li>
</ul>
</div>
<div id="synopsis" class="doctools_section"><h2><a name="synopsis">Synopsis</a></h2>
<div class="doctools_synopsis">
<ul class="doctools_requirements">
<li>package require <b class="pkgname">Img <span class="opt">?2.0?</span></b></li>
</ul>
</div>
</div>
<div id="section1" class="doctools_section"><h2><a name="section1">Description</a></h2>
<p><b class="package">Img</b> is a collection of format handlers for the <b class="package">Tk</b> <a href="https://www.tcl.tk/man/tcl9.0/TkCmd/photo.html">photo</a> image type.</p>
<p>Sources and binaries of <b class="package">Img</b> are available at <a href="https://sourceforge.net/projects/tkimg/">SourceForge</a>.</p>
<p>The individual formats are described in more detail on their own pages.</p>
<dl class="doctools_definitions">
<dt><i class="term">bmp</i></dt>
<dd><p>Windows bitmap format.
See <b class="cmd"><a href="img-bmp.html">img-bmp</a></b>.</p></dd>
<dt><i class="term">dted*</i></dt>
<dd><p>Digital Terrain Elevation Data format.
See <b class="cmd"><a href="img-dted.html">img-dted</a></b>.</p></dd>
<dt><i class="term">flir*</i></dt>
<dd><p>FLIR FPF Public Image format.
See <b class="cmd"><a href="img-flir.html">img-flir</a></b>.</p></dd>
<dt><i class="term">gif*</i></dt>
<dd><p>Graphics Interchange Format.
See <b class="cmd"><a href="img-gif.html">img-gif</a></b>.</p></dd>
<dt><i class="term">ico</i></dt>
<dd><p>Windows icon format.
See <b class="cmd"><a href="img-ico.html">img-ico</a></b>.</p></dd>
<dt><i class="term">jpeg</i></dt>
<dd><p>Joint Picture Experts Group format.
See <b class="cmd"><a href="img-jpeg.html">img-jpeg</a></b>.</p></dd>
<dt><i class="term">pcx</i></dt>
<dd><p>Paintbrush format.
See <b class="cmd"><a href="img-pcx.html">img-pcx</a></b>.</p></dd>
<dt><i class="term">pixmap</i></dt>
<dd><p>Pixmap image type.
While the other formats are handlers for the <b class="package">Tk</b> photo image
type, this is a new image type for <b class="package">Tk</b>.
See <b class="cmd"><a href="img-pixmap.html">img-pixmap</a></b>.</p></dd>
<dt><i class="term">png</i></dt>
<dd><p>Portable Network Graphics format.
See <b class="cmd"><a href="img-png.html">img-png</a></b>.</p></dd>
<dt><i class="term">ppm</i></dt>
<dd><p>Portable pixmap format.
See <b class="cmd"><a href="img-ppm.html">img-ppm</a></b>.</p></dd>
<dt><i class="term">ps*</i></dt>
<dd><p>Postscript and PDF format.
Requires an external application, <b class="syscmd">ghostview</b> for its operation.
See <b class="cmd"><a href="img-ps.html">img-ps</a></b>.</p></dd>
<dt><i class="term">raw*</i></dt>
<dd><p>Raw data format.
See <b class="cmd"><a href="img-raw.html">img-raw</a></b>.</p></dd>
<dt><i class="term">sgi</i></dt>
<dd><p>Silicon Graphics format.
See <b class="cmd"><a href="img-sgi.html">img-sgi</a></b>.</p></dd>
<dt><i class="term">sun</i></dt>
<dd><p>Sun raster format.
See <b class="cmd"><a href="img-sun.html">img-sun</a></b>.</p></dd>
<dt><i class="term">tga</i></dt>
<dd><p>Truevision Targa format.
See <b class="cmd"><a href="img-tga.html">img-tga</a></b>.</p></dd>
<dt><i class="term">tiff</i></dt>
<dd><p>Tagged Image File Format.
See <b class="cmd"><a href="img-tiff.html">img-tiff</a></b>.</p></dd>
<dt><i class="term">window</i></dt>
<dd><p>Tk window as photo image.
See <b class="cmd"><a href="img-window.html">img-window</a></b>.</p></dd>
<dt><i class="term">xbm</i></dt>
<dd><p>X Windows Bitmap format.
See <b class="cmd"><a href="img-xbm.html">img-xbm</a></b>.</p></dd>
<dt><i class="term">xpm</i></dt>
<dd><p>X Windows Pixmap format.
See <b class="cmd"><a href="img-xpm.html">img-xpm</a></b>.</p></dd>
</dl>
</div>
<div id="section2" class="doctools_section"><h2><a name="section2">Notes</a></h2>
<ol class="doctools_enumerated">
<li><p><b class="package">Img</b> version 2 only works with Tcl/Tk 8.6 or newer.
If using an older Tcl/Tk version, use the lastest <b class="package">Img</b> 1.4 version.</p></li>
<li><p>Formats marked with <em>*</em> are <em>not</em> loaded when doing a
<b class="cmd">package require Img</b>, but must be loaded explicitly via
<b class="cmd">package require img::FORMAT</b>.</p></li>
</ol>
</div>
<div id="section3" class="doctools_section"><h2><a name="section3">Multi-page Images</a></h2>
<p>Some image formats support storage of multiple pages in a file.</p>
<p>Supported by formats <b class="cmd"><a href="img-gif.html">img-gif</a></b>, <b class="cmd"><a href="img-ico.html">img-ico</a></b>, <b class="cmd"><a href="img-ps.html">img-ps</a></b>, <b class="cmd"><a href="img-tiff.html">img-tiff</a></b>.</p>
<p>A specific page can be extracted using the <b class="option">-index</b> option.
Index <b class="const">0</b> specifies the first page.</p>
<p>There is currently no support for writing multi-page images.</p>
<p>The number of pages of an image file can either be retrieved using metadata key <em>numpages</em>
(see chapter <span class="sectref"><a href="#section4">Image Metadata</a></span>) or by checking different <b class="option">-index</b> values.</p>
<p>For example, GIF images can have multiple pages in one file.
The metadata dictionary key <em>numpages</em> is not supported for GIF images,
as this property cannot be extracted fast.</p>
<p>If you need to know the number of pages, use code like in the following example:</p>
<pre class="doctools_example">
 proc CheckIndex { fileName fmt ind } {
     set retVal [catch {image create photo -file $fileName -format &quot;$fmt -index $ind&quot;} phImg]
     if { $retVal == 0 } {
         image delete $phImg
         return true
     }
     return false
 }
 
 proc GetNumPages { fileName fmt } {
     if { [CheckIndex $fileName $fmt 1] } {
         set ind 5
         while { [CheckIndex $fileName $fmt $ind] } {
             incr ind 5
         }
         incr ind -1
         while { ! [CheckIndex $fileName $fmt $ind] } {
             incr ind -1
         }
         return [expr { $ind + 1 }]
     }
     return 1
 }
 
 # Determine the number of pages of an animated GIF.
 set numPages [GetNumPages $imgFile &quot;gif&quot;]
</pre>
</div>
<div id="section4" class="doctools_section"><h2><a name="section4">Image Metadata</a></h2>
<p>Some image formats support an individual set of metadata dictionary keys.
See the <b class="package">Tk</b> <a href="https://www.tcl.tk/man/tcl9.0/TkCmd/photo.html">photo</a> image command for more information regarding image metadata.</p>
<p>This support is enabled, if <b class="package">Img</b> is linked against <b class="package">Tk</b> 8.7 or newer.</p>
<p>The following keys are supported:</p>
<dl class="doctools_definitions">
<dt><i class="term">DPI</i></dt>
<dd><p>Horizontal image resolution in dots per inch as double value.</p>
<p>Supported by formats <b class="cmd"><a href="img-bmp.html">img-bmp</a></b>, <b class="cmd"><a href="img-jpeg.html">img-jpeg</a></b>, <b class="cmd"><a href="img-pcx.html">img-pcx</a></b>, <b class="cmd"><a href="img-png.html">img-png</a></b>, <b class="cmd"><a href="img-tiff.html">img-tiff</a></b>.</p></dd>
<dt><i class="term">aspect</i></dt>
<dd><p>Aspect ratio defined as horizontal size divided by vertical size as double value.</p>
<p>Supported by formats <b class="cmd"><a href="img-bmp.html">img-bmp</a></b>, <b class="cmd"><a href="img-jpeg.html">img-jpeg</a></b>, <b class="cmd"><a href="img-pcx.html">img-pcx</a></b>, <b class="cmd"><a href="img-png.html">img-png</a></b>, <b class="cmd"><a href="img-tiff.html">img-tiff</a></b>.</p></dd>
<dt><i class="term">numpages</i></dt>
<dd><p>The number of pages in an image file.</p>
<p>Supported by formats <b class="cmd"><a href="img-ico.html">img-ico</a></b>, <b class="cmd"><a href="img-tiff.html">img-tiff</a></b>.</p></dd>
</dl>
<p>All formats supporting image resolution (<em>DPI</em> and <em>aspect</em>)
have the following format options for writing these values without explicitly setting the metadata dictionary:</p>
<p><b class="option">-resolution</b> <b class="option">-xresolution</b> <b class="option">-yresolution</b>.</p>
<ol class="doctools_enumerated">
<li><p>Option <b class="option">-resolution</b> allows specifying both horizontal and vertical resolution values.</p></li>
<li><p>If not using option <b class="option">-resolution</b>, options <b class="option">-xresolution</b> and <b class="option">-yresolution</b> must both be specified.
Otherwise no resolution information is written.</p></li>
<li><p>Resolution values specified with any of the above options overwrite the corresponding metadata dictionary values.</p></li>
<li><p>The  resolution values can be specified as double values as documented with function
<a href="https://www.tcl.tk/man/tcl9.0/TkLib/GetPixels.html">Tk_GetPixels</a>.</p></li>
</ol>
<p>Example resolution specifications:</p>
<pre class="doctools_example">
1.0: 1 inch
1i : 1 inch
1c : 1 centimeter
1m : 1 millimeter
1p : 1 point
</pre>
<p>Example writing PNG image with horizontal resolution of 300 inches and vertical resolution of 200 centimeters:</p>
<pre class="doctools_example">
img write out.png -format {png -resolution 300i 200c}
</pre>
</div>
<div id="section5" class="doctools_section"><h2><a name="section5">Value Mapping</a></h2>
<p>Some image formats support pixel values greater than storable in 8-bit integers.</p>
<ul class="doctools_itemized">
<li><p>The following formats support 16-bit integer pixel values: <b class="cmd"><a href="img-dted.html">img-dted</a></b>, <b class="cmd"><a href="img-ppm.html">img-ppm</a></b>.</p></li>
<li><p>The following formats support floating point pixel values: <b class="cmd"><a href="img-flir.html">img-flir</a></b>, <b class="cmd"><a href="img-raw.html">img-raw</a></b>.</p></li>
</ul>
<p>To map these values to 8-bit integer values as needed for a Tk photo, two different algorithms
are implemented in Img:</p>
<p>A simple <em>MinMax</em> algorithm and an advanced <em>Automatic Gain Control (AGC)</em> algorithm
using histogram equalization.</p>
<p>The default for all supported formats is to use the <em>MinMax</em> algorithm, which determines
the minimum and maximum values of the image automatically.</p>
</div>
<div id="section6" class="doctools_section"><h2><a name="section6">Matching Order</a></h2>
<p>When reading images without specifying the format (using option <b class="option">-format</b>),
the match functions of the available formats are tried in reversed order as registered.
So, the handlers of the Img package are called before the handlers of the Tk core.
The Tk core registers the following handlers: GIF, PNG, PPM, SVG, DEFAULT.</p>
<p>In Tk 8.7 a new format handler structure (<b class="type">Tk_PhotoImageFormatVersion3</b>) was introduced
to handle the new metadata information.
All old handlers (<b class="type">Tk_PhotoImageFormat</b>) are called before calling the new Format3 handlers.</p>
<p>See manual page of function <a href="https://www.tcl.tk/man/tcl9.0/TkLib/CrtPhImgFmt.html">Tk_CreatePhotoImageFormat</a>
for a detailed description of the handler struture and matching functions.</p>
<p>The resulting matching order is best explained by an example:</p>
<pre class="doctools_example">
package require Tk
package require Img
package require img::raw     <em>(Format2 Img handler)</em>
</pre>
<p>Note, that the <b class="cmd">package require Img</b> command actually calls the following statements:</p>
<pre class="doctools_example">
package require img::window  <em>(Format2 Img handler)</em>
package require img::tga     <em>(Format2 Img handler)</em>
package require img::ico     <em>(Format3 Img handler)</em>
package require img::pcx     <em>(Format3 Img handler)</em>
package require img::sgi     <em>(Format2 Img handler)</em>
package require img::sun     <em>(Format2 Img handler)</em>
package require img::xbm     <em>(Format2 Img handler)</em>
package require img::xpm     <em>(Format2 Img handler)</em>
package require img::jpeg    <em>(Format3 Img handler)</em>
package require img::png     <em>(Format3 Img handler)</em>
package require img::tiff    <em>(Format3 Img handler)</em>
package require img::bmp     <em>(Format3 Img handler)</em>
package require img::ppm     <em>(Format2 Img handler)</em>
</pre>
<p>The order of calling the match functions is therefore as follows:</p>
<pre class="doctools_example">
Match format raw       <em>(Format2 Img handler)</em>
Match format ppm       <em>(Format2 Img handler)</em>
Match format xpm       <em>(Format2 Img handler)</em>
Match format xbm       <em>(Format2 Img handler)</em>
Match format sun       <em>(Format2 Img handler)</em>
Match format sgi       <em>(Format2 Img handler)</em>
Match format tga       <em>(Format2 Img handler)</em>
Match format window    <em>(Format2 Img handler)</em>
Match format svg       <em>(Format2 Tk handler)</em>
Match format ppm       <em>(Format2 Tk handler)</em>
Match format default   <em>(Format2 Tk handler)</em>
Match format bmp       <em>(Format3 Img handler)</em>
Match format tiff      <em>(Format3 Img handler)</em>
Match format png       <em>(Format3 Img handler)</em>
Match format jpeg      <em>(Format3 Img handler)</em>
Match format pcx       <em>(Format3 Img handler)</em>
Match format ico       <em>(Format3 Img handler)</em>
Match format png       <em>(Format3 Tk handler)</em>
Match format gif       <em>(Format3 Tk handler)</em>
</pre>
</div>
<div id="see-also" class="doctools_section"><h2><a name="see-also">See Also</a></h2>
<p>img, <a href="img-bmp.html">img-bmp</a>, <a href="img-dted.html">img-dted</a>, <a href="img-flir.html">img-flir</a>, <a href="img-gif.html">img-gif</a>, <a href="img-ico.html">img-ico</a>, <a href="img-jpeg.html">img-jpeg</a>, <a href="img-pcx.html">img-pcx</a>, <a href="img-pixmap.html">img-pixmap</a>, <a href="img-png.html">img-png</a>, <a href="img-ppm.html">img-ppm</a>, <a href="img-ps.html">img-ps</a>, <a href="img-raw.html">img-raw</a>, <a href="img-sgi.html">img-sgi</a>, <a href="img-sun.html">img-sun</a>, <a href="img-tga.html">img-tga</a>, <a href="img-tiff.html">img-tiff</a>, <a href="img-window.html">img-window</a>, <a href="img-xbm.html">img-xbm</a>, <a href="img-xpm.html">img-xpm</a></p>
</div>
<div id="copyright" class="doctools_section"><h2><a name="copyright">Copyright</a></h2>
<p>Copyright &copy; 1995-2024 Jan Nijtmans &lt;nijtmans@users.sourceforge.net&gt;<br>
Copyright &copy; 2002-2024 Andreas Kupries &lt;andreas_kupries@users.sourceforge.net&gt;<br>
Copyright &copy; 2003-2024 Paul Obermeier &lt;obermeier@users.sourceforge.net&gt;</p>
</div>
</div></body></html>
